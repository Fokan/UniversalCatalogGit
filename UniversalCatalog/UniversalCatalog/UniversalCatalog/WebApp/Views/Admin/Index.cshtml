
@{
    ViewBag.Title = "Index";
}

@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/jqueryval")
<h2>Hello Admin!</h2>

<div class="panel panel-primary">
    <div class="panel-heading">
        <h3 class="panel-title">Settings</h3>
    </div>
    <div class="panel-body">
        <div class="btn-toolbar">
            @Html.ActionLink("Users", "Users", "Admin", null, htmlAttributes: new { @class = "btn btn-dafault" })
            @Html.ActionLink("Types", "Index", "Types", null, htmlAttributes: new { @class = "btn btn-dafault" })
            @Html.ActionLink("Properties", "Index", "Propertys", null, htmlAttributes: new { @class = "btn btn-dafault" })
            @Html.ActionLink("Items", "Index", "Items", null, htmlAttributes: new { @class = "btn btn-dafault" })
        </div>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading">
        <div class="panel-title">
            <div class="pull-left">
                <h3 >Images for slider</h3>
            </div>
            <div class="pull-right">
                <button id="fileupload" class="btn btn-primary">+</button>
            </div>
            <div style="clear:both;"></div>
        </div>

    </div>
    <div class="panel-body">
        <div class="btn-toolbar" id="imageList">
                @foreach (var path in ViewBag.Paths)
                {
                    <div class="img-thumbnail text-center imageBox">
                        <img src="@path" width="300" height="120" /><br />
                        <input type="button" class="imgDelete btn btn-default bottom" value="Delete" data-img="@path" />
                    </div>
                }
        </div>
    </div>
</div>

<div style="display:none;">
    @*@using (Ajax.BeginForm("AddSlideImage", null, new AjaxOptions
    {
        //UpdateTargetId = "results",
        Confirm = "Выполнить AJAX-запрос?",
        OnFailure = "OnFailure",
        OnSuccess = "OnSuccess",
    }, htmlAttributes: new { enctype = "multipart/form-data", @id="temporaryForm" }))*@
    @using (Html.BeginForm("AddSlideImage", "Admin", FormMethod.Post, htmlAttributes: new { enctype = "multipart/form-data", @id = "temporaryForm" }))
    {
        <input type='file' id='file' name='File' @*style='display:none;'*@ accept='image/jpeg,image/gif,image/x-png' />
        <input type="submit" id="submitImageForm" />
    }
</div>

<script>
    //function OnFailure(request, error) {
    //    $("#results").html("Книги указанного автора не содержатся в базе данных.");
    //}
    //function OnComplete(request, status) {
    //    alert("Статус запроса : " + status);
    //}

    $(document).ready(function(){
        $(document).on('click', '.imgDelete', function () {
            var src = $(this).data("img");
            $.post("/Admin/DeleteSlideImage", { ImageSRC: src });
            $(this).parent(".img-thumbnail").hide();
        });

        $(document).on('click', '#fileupload', function () {
            $("#file").click();
        });
        $(document).on('click', '#file', function (e) {
            e.stopPropagation();
        });
        $(document).on('change', '#file', function () {
            //$('#temporaryForm').submit();
            $('#submitImageForm').click();
            //var file = $("#file").file;

            //$.ajax({
            //    url: "/admin/AddSlideImage",
            //    data: { File: file }
            //});
        });


    });
</script>

<style>
    .imgDelete
    {
        margin-top:5px;
        width:100%;
    }

    #imageList
    {
        display:flex;
	    flex-wrap:wrap;
	    align-content:space-around;
	    justify-content:center;
    }
    .imageBox
    {
        margin:10px;
    }
    
</style>